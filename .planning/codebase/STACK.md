# Technology Stack

**Analysis Date:** 2026-01-10

## Languages

**Primary:**
- C99 - All firmware source files in `firmware/src/`

**Secondary:**
- Assembly - Microcontroller startup code (generated by Harmony)

## Runtime

**Environment:**
- PIC32MZ2048EFM144 - 32-bit MIPS-based microcontroller
  - 256KB RAM, 2MB Flash
  - 144-pin LQFP package
  - Device definition: `firmware/src/config/default/device.h`

- FreeRTOS Kernel V11.1.0 - Real-time operating system
  - Configuration: `firmware/src/config/default/FreeRTOSConfig.h`
  - Heap: 284KB (configTOTAL_HEAP_SIZE)
  - Heap implementation: heap_4 (best-fit with coalescence)
  - Tick rate: 1000 Hz
  - Max priorities: 10 levels
  - Preemptive scheduling enabled

**Package Manager:**
- Not applicable (embedded system)
- Dependencies managed via MPLAB Harmony Configurator (MHC)

## Frameworks

**Core:**
- Microchip Harmony 3 - Embedded software framework
  - Location: `firmware/src/config/default/`
  - Provides: PLIB abstractions, system services, driver abstractions
  - Auto-generated by Harmony Configurator

**Testing:**
- CUnit - Unit test framework (for SCPI library tests)
  - Location: `firmware/src/libraries/scpi/libscpi/test/`
  - Hardware testing via SCPI commands on live device

**Build/Dev:**
- MPLAB X IDE v6.25 - Development environment
- XC32 Compiler v4.60 - GCC-based C compiler for PIC32
  - Windows: `C:\Program Files\Microchip\xc32\v4.60\bin\`
  - Linux: `/opt/microchip/xc32/v4.60/bin/xc32-gcc`

## Key Dependencies

**Critical:**
- FreeRTOS 11.1.0 - Task scheduling and synchronization - `firmware/src/third_party/rtos/`
- nanopb - Protocol Buffer encoder for embedded - `firmware/src/libraries/nanopb/`
- libscpi v2 - SCPI command parser (IEEE 488.2) - `firmware/src/libraries/scpi/libscpi/`
- FatFS - FAT file system (Elm Chan) - `firmware/src/config/default/system/fs/fat_fs/`

**Infrastructure:**
- WolfSSL/WolfCrypt - TLS/SSL and cryptography - `firmware/src/third_party/wolfssl/`
- zlib - Compression library - `firmware/src/third_party/zlib/`
- microrl - Micro readline for CLI - `firmware/src/libraries/microrl/`

## Configuration

**Environment:**
- Build-time configuration via MPLAB X project settings
- Board variants: NQ1, NQ2, NQ3 (selected at compile time)
- Configuration files: `firmware/src/config/default/configuration.h`

**Build:**
- MPLAB X project: `firmware/daqifi.X/`
- Makefile configurations: `nbproject/Makefile-default.mk`, `Makefile-Nq1.mk`, `Makefile-Nq3.mk`
- Linker scripts: `old_hv2_bootld.ld` (for bootloader-compatible builds)

## Platform Requirements

**Development:**
- Windows or Linux (WSL supported)
- MPLAB X IDE v6.25
- XC32 Compiler v4.60
- PICkit 4 programmer/debugger

**Production:**
- PIC32MZ2048EFM144 microcontroller
- USB bootloader for firmware updates
- Distributed as hex file: `dist/default/production/daqifi.X.production.hex` (~1MB)

---

*Stack analysis: 2026-01-10*
*Update after major dependency changes*
